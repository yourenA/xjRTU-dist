(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{vviN:function(e,t,a){"use strict";var l=a("mZ4U"),r=a("fbTi");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("Jkyn");var n=l(a("DwzN"));a("CuyC");var s=l(a("PdMq"));a("nCvR");var d=l(a("otiJ")),o=l(a("mK77")),i=l(a("43Yg")),u=l(a("/tCh")),f=l(a("Tfcp")),c=l(a("scpF")),m=l(a("O/V9")),p=l(a("8aBX"));a("DvNH");var h=l(a("SzGI"));a("pLlE");var _=l(a("qQZ1"));a("5KzM");var Y,v,g,y,D=l(a("FCwu")),M=r(a("ZZRV")),E=(a("EaaV"),l(a("a/LZ"))),w=a("LneV"),S=l(a("t3Un")),b=l(a("eKz+")),k=l(a("voBT"));function z(e){return function(){var t,a=(0,m.default)(e);if(F()){var l=(0,m.default)(this).constructor;t=Reflect.construct(a,arguments,l)}else t=a.apply(this,arguments);return(0,c.default)(this,t)}}function F(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var R=D.default.Item,C=_.default.Option,N=(h.default.Search,h.default.TextArea,Y=(0,w.connect)(function(e){var t=e.login_logs,a=e.loading;return{login_logs:t,loading:a.models.login_logs}}),v=D.default.create(),Y(g=v((y=function(e){(0,p.default)(a,e);var t=z(a);function a(e){var l;return(0,i.default)(this,a),l=t.call(this,e),l.resize=function(){l.setState({tableY:document.querySelector(".table-page").offsetHeight-153})},l.handleSearch=function(e,t){console.log("handleSearch",e);var a=(0,f.default)(l),r=l.props.dispatch;r({type:"login_logs/fetch",payload:(0,o.default)({},e),callback:function(){console.log("handleSearch callback"),a.setState((0,o.default)({},e)),t&&t()}})},l.handleFormReset=function(){var e=l.props.form;e.resetFields(),l.handleSearch({page:1,username:"",per_page:30,started_at:(0,E.default)().format("YYYY-MM-DD"),ended_at:(0,E.default)().format("YYYY-MM-DD")})},l.permissions=JSON.parse(localStorage.getItem("permissions")),l.state={showAddBtn:(0,k.default)(l.permissions,{name:"user_add_and_edit"}),showdelBtn:(0,k.default)(l.permissions,{name:"user_delete"}),showPasswordBtn:(0,k.default)(l.permissions,{name:"user_default_password_edit"}),user_password_reset:(0,k.default)(l.permissions,{name:"user_password_reset"}),visible:!1,done:!1,page:1,per_page:30,user_id:"",editRecord:{},started_at:(0,E.default)().format("YYYY-MM-DD"),ended_at:(0,E.default)().format("YYYY-MM-DD"),users:[]},l}return(0,u.default)(a,[{key:"componentDidMount",value:function(){var e=this;(0,S.default)("/users",{method:"GET",params:{return:"all"}}).then(function(t){200===t.status&&e.setState({users:t.data.data})}),this.setState({tableY:document.querySelector(".table-page").offsetHeight-153});var t=this.props.dispatch;t({type:"login_logs/fetch",payload:{page:1,user_id:"",started_at:(0,E.default)().format("YYYY-MM-DD"),ended_at:(0,E.default)().format("YYYY-MM-DD")}}),window.addEventListener("resize",this.resize)}},{key:"componentWillUnmount",value:function(){console.log("componentWillUnmount"),window.removeEventListener("resize",this.resize)}},{key:"renderSimpleForm",value:function(){var e=this,t=this.props.form.getFieldDecorator;return M.default.createElement(D.default,{layout:"inline",className:"search-form"},M.default.createElement(R,{label:"\u7528\u6237\u540d"},t("user_id",{initialValue:""})(M.default.createElement(_.default,{style:{width:"120px"}},this.state.users.map(function(e,t){return M.default.createElement(C,{key:e.id,value:e.id.toString()},e.username)})))),M.default.createElement(R,{label:"\u5f00\u59cb\u65e5\u671f"},t("started_at",{initialValue:(0,E.default)()})(M.default.createElement(d.default,{format:"YYYY-MM-DD"}))),M.default.createElement(R,{label:"\u7ed3\u675f\u65e5\u671f"},t("ended_at",{initialValue:(0,E.default)()})(M.default.createElement(d.default,{format:"YYYY-MM-DD"}))),M.default.createElement(R,null,M.default.createElement(s.default,{type:"primary",icon:"search",onClick:function(){var t=e.props.form;t.validateFields(function(t,a){if(!t){var l=(0,o.default)({},a);e.handleSearch({page:1,per_page:e.state.per_page,user_id:l.user_id?l.user_id:"",started_at:a.started_at.format("YYYY-MM-DD"),ended_at:a.ended_at.format("YYYY-MM-DD")})}})}},"\u67e5\u8be2"),M.default.createElement(s.default,{style:{marginLeft:8},icon:"redo",onClick:this.handleFormReset},"\u91cd\u7f6e")))}},{key:"render",value:function(){var e=this.props.login_logs,t=e.data,a=e.loading,l=e.meta,r=(this.props.form.getFieldDecorator,[{title:"\u7528\u6237\u540d",dataIndex:"username",width:150},{title:"\u767b\u5f55\u65f6\u95f4",dataIndex:"created_at"}]);return M.default.createElement("div",{className:"table-box"},M.default.createElement("div",{className:"table-title"},"\u767b\u5f55\u65e5\u5fd7"),M.default.createElement("div",{className:"table-page"},M.default.createElement("div",null,M.default.createElement("div",null,this.renderSimpleForm()),M.default.createElement(n.default,{style:{color:"#fff"},className:"custom-small-table",loading:a,rowKey:"id",dataSource:t,columns:r,pagination:!1,size:"small",scroll:{x:!0,y:this.state.tableY}}),M.default.createElement(b.default,{searchCondition:{username:this.state.username,started_at:this.state.started_at,ended_at:this.state.ended_at},meta:l,handleSearch:this.handleSearch}))))}}]),a}(M.PureComponent),g=y))||g)||g),x=N;t.default=x}}]);